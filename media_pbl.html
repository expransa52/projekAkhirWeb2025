<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <title>Media Interaktif Sistem Pernapasan pada Manusia - Beranda</title>
    <link rel="icon" href="Logo.png">
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

<body>
    <div id="sidebar" class="sidebar">
        <div class="sidebar-header text-uppercase">menu</div>
        <a href="#" class="nav-link active" data-page="beranda"><i class="bi bi-house-door-fill"></i>Beranda</a>
        <a href="#" class="nav-link" data-page="materi"><i class="bi bi-journal-bookmark"></i>Materi</a>

        <div id="materi-sidebar-detail" class="materi-sidebar-detail d-none">
            <div class="sidebar-header text-uppercase" style="margin-top: 20px;">Detail Materi</div>
            <div id="materi-detail-list">
                <p class="text-white-50 p-3">Pilih materi untuk melihat detail di sini.</p>
            </div>
        </div>
        <a href="#" class="nav-link" data-page="kuis"><i class="bi bi-patch-question"></i>Kuis</a>
        <a href="#" class="nav-link" data-page="video"><i class="bi bi-play-circle"></i>Video </a>
        <a href="#" class="nav-link" data-page="tentang"><i class="bi bi-info-circle"></i>Tentang</a>

        <button class="logout-link" onclick="logout()"><i class="bi bi-box-arrow-right"></i>KELUAR</button>
    </div>

    <div id="main-content">
        <div class="topbar">
            <button class="sidebar-toggle" id="sidebarToggle"><i class="bi bi-list"></i></button>
            <marquee direction="left" class="pixel-marquee text-capitalize">
                apakah kamu siap belajar hari ini!
            </marquee>
        </div>

        <div id="beranda-page" class="beranda-bg page-section">
            <div class="pixel-bg-clouds">
                <svg width="100%" height="100%">
                    <rect x="30" y="30" width="80" height="20" fill="#fff" />
                    <rect x="200" y="50" width="100" height="25" fill="#fff" />
                    <rect x="450" y="20" width="90" height="18" fill="#fff" />
                    <rect x="700" y="60" width="70" height="15" fill="#fff" />
                </svg>
            </div>
            <div class="pixel-title">ARE YOU READY?<br>MEDIA INTERAKTIF SISTEM PERNAPASAN</div>
            <div class="pixel-subtitle">Belajar Sistem Pernapasan dengan Cara Menyenangkan!</div>
            <div class="pixel-character">
                <img src="paru.png" alt="Paru-paru Lucu" />
            </div>
            <div class="container">
                <div class="music-controls" style="position: absolute; top: 20px; right: 30px; z-index: 10;">
                    <audio id="audioPlayer">
                        <source src="Musik untuk projek akhir.mp3" type="audio/mpeg">
                        Browser tidak mendukung audio.
                    </audio>
                    <button class="btn-circle" id="volumeBtn" title="Mute/Unmute">
                        <i id="volume-icon" class="fas fa-volume-up"></i>
                    </button>
                    <button class="btn-circle" id="musicBtn" title="Play/Pause">
                        <i id="music-icon" class="fas fa-music"></i>
                    </button>
                </div>

                <div class="row justify-content-center">
                    <div class="col-12 pixel-menu-row">
                        <button class="pixel-btn" onclick="showPage('materi')"><i
                                class="bi bi-journal-bookmark"></i>MATERI</button>
                        <button class="pixel-btn" onclick="showPage('kuis')"><i
                                class="bi bi-patch-question"></i>KUIS</button>
                    </div>
                    <div class="col-12 pixel-menu-row">
                        <button class="pixel-btn" onclick="showPage('video')"><i
                                class="bi bi-play-circle"></i>VIDEO</button>
                        <button class="pixel-btn" onclick="showPage('tentang')"><i
                                class="bi bi-info-circle"></i>TENTANG</button>
                        <button class="pixel-btn" onclick="logout()"><i
                                class="bi bi-box-arrow-right"></i>KELUAR</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="materi-page" class="fitur-page-materi page-section d-none">
            <div class="fitur-title">Materi Sistem Pernapasan</div>
            <div class="fitur-content" id="materi-content-from-firebase">
                <p>Memuat materi...</p>
            </div>
        </div>

        <div id="kuis-page" class="fitur-page page-section d-none">
            <div class="fitur-title">Kuis</div>
            <div class="fitur-content">
                <p>Konten Kuis akan ada di sini atau dimuat dari Kuis.html.</p>
            </div>
        </div>

        <div id="video-page" class="fitur-page page-section d-none">
            <div class="fitur-title">Video Pembelajaran</div>
            <div class="fitur-content video-grid-container">
                <h4 class="video-section-heading text-capitalize">ada berbagai video pembelajaran untuk di tonton:</h4>

                <iframe width="560" height="315" src="https://www.youtube.com/embed/AKW3Zen8DD4?si=LwwDSztZlHughRO9"
                    title="Sistem Pernapasan Manusia" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>


                <iframe width="560" height="315" src="https://www.youtube.com/embed/BN_kF5BYrT4?si=pGTywFVR-sOUzu7p"
                    title="Sistem Pernapasan pada Manusia" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

                <iframe width="560" height="315" src="https://www.youtube.com/embed/s48V8Edn328?si=GXzGGUxQ14Gdz7CQ"
                    title="Video Materi Pernapasan Manusia" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-in; gyroscope; picture-in-picture; web-share"
                    referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

                <iframe width="560" height="315" src="https://www.youtube.com/embed/oQPfpHYmkew?si=LPl3VhdaapK3hphC"
                    title="Organ Pernapasan Manusia" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

                <iframe width="560" height="315" src="https://www.youtube.com/embed/U31-lddMz9M?si=yDG2wCQDY8yEgU3f"
                    title="Proses Pernapasan Manusia" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

                <iframe width="560" height="315" src="https://www.youtube.com/embed/Y3DuNMBZTAA?si=Snnqos9JmrXrX038"
                    title="Gangguan Sistem Pernapasan" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

            </div>
        </div>
    </div>

    <div id="tentang-page" class="fitur-page page-section d-none">
        <div class="fitur-title">Tentang</div>
        <div class="fitur-content" id="tentang-content-from-firebase">
            <p>Memuat konten...</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-analytics.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-database.js";

        const subjudulGambarMapping = [
            { "judul_sub": "Hewan Bersel Satu (Uniseluler)", "gambar_sub": "sel1.jpeg" },
            { "judul_sub": "Cacing Tanah (Annelida)", "gambar_sub": "Cacing.jpg" },
            { "judul_sub": "Serangga (Insekta)", "gambar_sub": "seranggaa.jpg" },
            { "judul_sub": "Ikan (Pisces)", "gambar_sub": "Ikan.jpg" },
            { "judul_sub": "Katak dan Amfibi", "gambar_sub": "katak.jpg" },
            { "judul_sub": "Reptil", "gambar_sub": "Reptil.jpg" },
            { "judul_sub": "Burung (Aves)", "gambar_sub": "aves.jpg" },
            { "judul_sub": "Mamalia", "gambar_sub": "mamaliaaa.jpg" },
            { "judul_sub": "Struktur Organ Pernapasan", "gambar_sub": "strukturorganpernapasan.jpg" },
            { "judul_sub": "Mekanisme Pernapasan", "gambar_sub": "Mekanisme pernapasan.jpg" },
            { "judul_sub": "Pertukaran Gas di Paru-paru dan Jaringan", "gambar_sub": "Pertukaran gas.jpg" },
            { "judul_sub": "Fungsi Tambahan Sistem Pernapasan", "gambar_sub": "Bersin.jpg" },
            { "judul_sub": "Jenis Pernapasan pada Manusia", "gambar_sub": "Macammacampernapasan.jpg" },
            { "judul_sub": "Faktor yang Mempengaruhi Fungsi Pernapasan", "gambar_sub": "Rokok.jpg" },
            { "judul_sub": "Asma", "gambar_sub": "Asma d.jpg" },
            { "judul_sub": "Bronkitis", "gambar_sub": "Bronkitis.jpg" },
            { "judul_sub": "Pneumonia", "gambar_sub": "Pneumonia.jpg" },
            { "judul_sub": "Tuberkulosis (TBC)", "gambar_sub": "tuberkolosis.jfif.jpg" },
            { "judul_sub": "Emfisema", "gambar_sub": "gambar-emfisema.webp" },
            { "judul_sub": "ISPA (Infeksi Saluran Pernapasan Akut)", "gambar_sub": "Ispa.jpg" },
            { "judul_sub": "Kanker Paru-paru", "gambar_sub": "Kanker-Paru-paru.webp" }
        ];

        const gambarMap = {};
        subjudulGambarMapping.forEach(item => {
            gambarMap[item.judul_sub] = item.gambar_sub;
        });

        const firebaseConfigMateri = {
            apiKey: "AIzaSyDWS-yRGyvLClGWiBeq_Z_BcZ-kBgHll8M",
            authDomain: "materiprojek-70911.firebaseapp.com",
            databaseURL: "https://materiprojek-70911-default-rtdb.firebaseio.com",
            projectId: "materiprojek-70911",
            storageBucket: "materiprojek-70911.firebasestorage.app",
            messagingSenderId: "755242949891",
            appId: "1:755242949891:web:2bbde5a922b54cfa0f9d36",
            measurementId: "G-137P86T9LE"
        };

        const firebaseConfigTentang = {
            apiKey: "AIzaSyAVDh4dG81_JlmkMmIztd4m9gRaO-msMYc",
            authDomain: "tentang-web.firebaseapp.com",
            databaseURL: "https://tentang-web-default-rtdb.firebaseio.com",
            projectId: "tentang-web",
            storageBucket: "tentang-web.firebasestorage.app",
            messagingSenderId: "262389729779",
            appId: "1:262389729779:web:3e1ea6a3d725d764ea6a86"
        };

        const appMateri = initializeApp(firebaseConfigMateri, "materiApp");
        const analytics = getAnalytics(appMateri);
        const databaseMateri = getDatabase(appMateri);

        const appTentang = initializeApp(firebaseConfigTentang, "tentangApp");
        const databaseTentang = getDatabase(appTentang);

        const materiRef = ref(databaseMateri, 'materi_sistem_pernapasan');
        const materiContentDiv = document.getElementById('materi-content-from-firebase');

        let materiDetailDiv = document.getElementById('materi-detail-page');
        if (!materiDetailDiv) {
            materiDetailDiv = document.createElement('div');
            materiDetailDiv.id = 'materi-detail-page';
            materiDetailDiv.className = 'materi-detail-page d-none';
            materiContentDiv.parentNode.appendChild(materiDetailDiv);
        }

        const materiDetailListDiv = document.getElementById('materi-detail-list');
        const materiSidebarDetail = document.getElementById('materi-sidebar-detail');

        onValue(materiRef, (snapshot) => {
            const materiData = snapshot.val();

            if (materiData && materiData.subbab && Array.isArray(materiData.subbab)) {
                let materiHtml = '';
                if (materiData.judul) {
                    materiHtml += `<h2 class="materi-main-title text-center mb-4">${materiData.judul}</h2>`;
                }
                materiHtml += `<div class="materi-cards-container">`;

                const gambarStatis = [
                    "domba-dimateri.jpg",
                    "Manusia-dimateri.jpg",
                    "Gangguan.jpg"
                ];

                materiData.subbab.forEach((subbab, idx) => {
                    let gambar = gambarStatis[idx] || "https://via.placeholder.com/150";

                    materiHtml += `
                    <div class="materi-wrapper">
                        <div class="materi-image">
                            <img src="${gambar}" alt="Gambar ${subbab.judul}" style="width: 80%; height: 200px;">
                        </div>
                        <div class="materi-content">
                            <h3 class="materi-title">${subbab.judul}</h3>
                            <button class="btn-detail" data-idx="${idx}">Lihat Detail</button>
                        </div>
                    </div>
                    `;
                });

                materiHtml += `</div>`;
                materiContentDiv.innerHTML = materiHtml;
                materiContentDiv.classList.remove('d-none');
                materiDetailDiv.classList.add('d-none');

                materiSidebarDetail.classList.add('d-none');

                document.querySelectorAll('.btn-detail').forEach(btn => {
                    btn.onclick = () => {
                        const idx = btn.getAttribute('data-idx');
                        showMateriDetail(parseInt(idx), materiData);
                        document.querySelectorAll('#sidebar .nav-link').forEach(l => l.classList.remove('active'));
                        document.querySelector('#sidebar .nav-link[data-page="materi"]').classList.add('active');
                    };
                });

                const mainMaterialCategories = [
                    { title: "Sistem Pernapasan pada Hewan", idx: 0 },
                    { title: "Sistem Pernapasan pada Manusia", idx: 1 },
                    { title: "Gangguan pada Sistem Pernapasan", idx: 2 }
                ];

                function showMateriDetail(selectedIdx, materiData) {
                    const subbab = materiData.subbab[selectedIdx];
                    if (!subbab) {
                        console.error("Materi dengan indeks ini tidak ditemukan:", selectedIdx);
                        return;
                    }

                    let detailHtml = `<button class="btn-back-materi pixel-btn" style="margin-bottom: 20px;">← Kembali</button>`;
                    detailHtml += `<h2 id="materi-top">${subbab.judul}</h2>`;

                    if (subbab.isi && Array.isArray(subbab.isi)) {
                        subbab.isi.forEach((item, subIdx) => {
                            const gambarDetail = gambarMap[item.judul_sub] || 'https://via.placeholder.com/50x50?text=No+Image';
                            const elementId = `subbab-item-${selectedIdx}-${subIdx}`;

                            if (item.judul_sub) {
                                detailHtml += `
                                <h4 class="teks" id="${elementId}">${item.judul_sub}</h4>
                                    <div class="subjudul-dengan-gambar">
                                        <img src="${gambarDetail}" alt="${item.judul_sub}" class="gambar-subjudul">
                                    </div>
                                `;
                            }
                            if (item.isi_sub) detailHtml += `<p class="teks-sub" style="font-size: 20px";>${item.isi_sub}</p>`;
                        });
                    }

                    let sidebarDetailHtml = `<ul>`;
                    mainMaterialCategories.forEach(category => {
                        const actualSubbabTitle = materiData.subbab[category.idx] ? materiData.subbab[category.idx].judul : category.title;
                        const isActive = (category.idx === selectedIdx) ? 'active-sub' : '';
                        sidebarDetailHtml += `
                            <li class="sub-materi-item ${isActive}" data-main-idx="${category.idx}" data-scroll-to-id="materi-top">
                                ${actualSubbabTitle}
                            </li>`;
                    });
                    sidebarDetailHtml += `</ul>`;

                    materiDetailDiv.innerHTML = detailHtml;
                    materiContentDiv.classList.add('d-none');
                    materiDetailDiv.classList.remove('d-none');

                    materiDetailListDiv.innerHTML = sidebarDetailHtml;
                    materiSidebarDetail.classList.remove('d-none');

                    document.querySelectorAll('.sub-materi-item').forEach(item => {
                        item.addEventListener('click', function () {
                            const newIdx = parseInt(this.getAttribute('data-main-idx'));

                            document.querySelectorAll('.sub-materi-item').forEach(subItem => subItem.classList.remove('active-sub'));
                            this.classList.add('active-sub');

                            showMateriDetail(newIdx, materiData);

                            const mainContentElement = document.getElementById('main-content');
                            if (mainContentElement) {
                                mainContentElement.scrollTo({ top: materiDetailDiv.offsetTop - 100, behavior: 'smooth' });
                            } else {
                                window.scrollTo({ top: materiDetailDiv.offsetTop - 100, behavior: 'smooth' });
                            }
                        });
                    });

                    materiDetailDiv.querySelector('.btn-back-materi').onclick = () => {
                        materiDetailDiv.classList.add('d-none');
                        materiContentDiv.classList.remove('d-none');
                        materiSidebarDetail.classList.add('d-none');
                        const mainContentElement = document.getElementById('main-content');
                        if (mainContentElement) {
                            mainContentElement.scrollTo({ top: materiContentDiv.offsetTop - 30, behavior: 'smooth' });
                        } else {
                            window.scrollTo({ top: materiContentDiv.offsetTop - 30, behavior: 'smooth' });
                        }
                    };
                }

            } else {
                materiContentDiv.innerHTML = "<p>Konten materi tidak ditemukan di database atau kosong.</p>";
            }
        }, (error) => {
            console.error("Error membaca data 'materi':", error);
            materiContentDiv.innerHTML = "<p>Terjadi kesalahan saat memuat materi. Periksa konsol browser untuk detail.</p>";
        });

        const tentangRef = ref(databaseTentang, 'tentang');
        const tentangContentDiv = document.getElementById('tentang-content-from-firebase');

        onValue(tentangRef, (snapshot) => {
            const tentangTextFromFirebase = snapshot.val();

            const profileHtmlContent = `
            <section id="profile" class="container mt-5 text-center">
                <div class="d-flex justify-content-center flex-wrap mb-4" style="gap: 10px;">
                <img src="Profil Singkat 1.png" class="img-fluid" style="width: 550px; height: 300px" alt="Profil singkat">
                </div>

                <h2 class="mb-4 giant-text">Profil Singkat</h2>

                <div class="row row-cols-1 g-4">
                </div>
            </section>

            <div class="container">
                <div class="profile-row">
                <img src="Aisyah 1.png" class="profile-img" alt="Aisyah">
                <div class="profile-text">
                    <p>Nama: Aisyah Azimah</p>
                    <p>NIM: 2410131220005</p>
                    <p>Tanggal Lahir: 26 Juni 2006</p>
                    <p>E-Mail: <a href="mailto:aisyahazimah7@gmail.com">aisyahazimah7@gmail.com</a></p>
                    <p>Tugas:<br>
                        1. Membuat logo di bagian tab browser<br>
                        2. Membuat gambar profil singkat dan isi profil singkatnya<br>
                        3. Menambahkan music di bagian beranda yaitu putar/pouse dan membisukan music.<br>
                        4. Menambah css eksternal untuk setiap halaman website.<br>
                        5. Menambahkan JS musik<br>
                        6. Mencari video pembelajaran.<br>
                        7. Menambah JS Beranda, Sidebar, dan Toogle</p>
                </div>
                </div>

                <div class="profile-row">
                <img src="Ekspransa 2.png" class="profile-img" alt="Ekspransa">
                <div class="profile-text">
                    <p>Nama: Expransa Saputra</p>
                    <p>NIM: 2410131210003</p>
                    <p>Tanggal Lahir: 7 Desember 2005</p>
                    <p>E-Mail: <a href="mailto:expransasaputra@gmail.com">expransasaputra@gmail.com</a></p>
                    <p>Tugas:<br>
                        1. Membuat halaman Beranda, Sidebar, Fitur,
                        dan gambar di bagian beranda sama teks berjalan<br>
                        2. Membuat halaman materi dari firebase dan gambar judul materinya<br>
                        3. Membuat halaman kuis dan kuisnya dari firebase, hasil akhir skor kuis nya dan
                        menambahkan timer pengerjaan kuis.<br>
                        4. Membuat JS bagian Kuis, Waktu kuis, materi, dan Mengarahkan fitur setiap di klik ke halaman tertentu.<br>
                        5. Menambahkan font pixel (Press Start 2P) dari Google Fonts untuk teks menjadi pixel.<br>
                        6. Menambahkan CSS Font Awesome untuk ikon-ikon di dalam sidebar, termasuk ikon rumah (Beranda), buku (Materi), tanda tanya (Kuis), play (Video), informasi (Tentang), dan pintu keluar (Keluar).<br>
                        7. Menambahkan Bootstrap CSS dan JS.
                    </p>
                </div>
                </div>

                <div class="profile-row">
                <img src="Bakeri 1.png" class="profile-img" alt="Bakeri">
                <div class="profile-text">
                    <p>Nama: Muhammad Bakeri</p>
                    <p>NIM: 2410131310009</p>
                    <p>Tanggal Lahir: 06 Desember 2005</p>
                    <p>E-Mail: <a href="mailto:mbakeri0612@gmail.com">mbakeri0612@gmail.com</a></p>
                    <p>Tugas:<br>
                        1. Membuat Halaman Login<br>
                        2. Membuat Pop Up JS costum<br>
                        3. Membuat Firebase bagian tentang<br>
                        4. Membuat JS untuk login interaktif, Pop Up JS costum,
                        dan tombol interaktif ke halaman lain<br>
                        5. Membuat JS nama tab browser setiap halaman berbeda-beda.<br>
                        6. Menambahkan Liblary JS dari Sweetalert2<br>
                        7. Menambahkan Bootstrap CSS dan JS.
                    </p>
                </div>
                </div>
            </div>
            `;
            if (tentangTextFromFirebase) {
                tentangContentDiv.innerHTML = tentangTextFromFirebase + profileHtmlContent;
            } else {
                tentangContentDiv.innerHTML = profileHtmlContent;
            }
        }, (error) => {
            console.error("Error membaca data 'tentang':", error);
            tentangContentDiv.innerHTML = "<p>Terjadi kesalahan saat memuat konten. Periksa konsol browser.</p>";
        });

    </script>

</body>

</html>
